View(gas15.cum)
View(gas15)
View(gas15.cum1)
source("Data/GatherSource/V1_MakeLikeFile.R")
source("Data/GatherSOurce/V1_RequiredPackages.R")
source("Data/GatherSOurce/V1_Gather1.R") # load data including fig2.data!
source("Data/GatherSOurce/V1_Gather2.R") # N2O data processing
source("Data/GatherSOurce/V1_RequiredPackages.R")
source("Data/GatherSOurce/V1_Gather1.R") # load data including fig2.data!
source("Data/GatherSOurce/V1_Gather2.R") # N2O data processing
source("Data/GatherSOurce/V1_Gather3.R") # CO2 data processing
gas15$date  <- as.POSIXlt(gas15$date)
gas15$treat <- factor(gas15$treat, levels = c("Lt", "Fc", "LF", "C")) #reorder levels
gas15$total.Ngas <- gas15$nitox.gc+gas15$dinitrogen
# Cumulative Gas15 (Total, N2, N2O-litter, N2O-soil) ####
# Cumulative gas between two dates
cumulative = function (x) 168*(x[i:(length(x)-j)]+0.5*(x[(i+j):length(x)]-x[i:(length(x)-j)]))
i=1
j=26
gas15.cum = matrix(0,78,4)
gas15.cum[,1] = cumulative(gas15$total)
gas15.cum[,2] = cumulative(gas15$dinitrogen)
gas15.cum[,3] = cumulative(gas15$nitox)
gas15.cum[,4] = cumulative(gas15$nitox.gc)
colnames(gas15.cum) = colnames(gas15[,c(22:24,14)])
# save data on growth between two dates
gas15.cum1 = gas15.cum
# New data to sum up
gas15.cum2 = gas15.cum
# sum up
for (i in 27:78)  {
for (j in 1:4) {
gas15.cum2[i,j] =  gas15.cum2[i,j] + gas15.cum2[i-26,j]
}
}
View(gas15.cum2)
gas15.cum2 = cbind(gas15[27:104,1:13], gas15.cum2)
104-27
View(gas15.cum2)
source("Data/GatherSource/V1_MakeLikeFile.R")
View(gas15.cum)
ggplot(gas15.cum, aes(x= Lt, y=nitox.pool),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(expression(paste("Fraction of ",N[2],O[Litter]))) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Fraction of ",N[2],O[Litter]))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
ggplot(gas15.cum, aes(x= Lt, y=nitox.soil),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.nitox.soil) +
xlab("italic(L.~terrestris)") +
ggtitle("Total N2O") +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
ggplot(gas15.cum, aes(x= Lt, y=nitox),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(expression(paste("Litter derived N2O"))) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Product Ratio"))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
ggplot(gas15.cum, aes(x= Lt, y=nitox),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.pool) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("litter derived N2O"))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
txt.pool = expression(paste(F[litter], N[2],"O"))
ggplot(gas15.cum, aes(x= Lt, y=nitox),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.pool) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("litter derived N2O"))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
txt.pool = expression(paste(F[litter]," ", N[2],"O"))
ggplot(gas15.cum, aes(x= Lt, y=nitox),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.pool) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Litter derived ", N[2], "O"))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
ggplot(gas15.cum, aes(x= Lt, y=nitox.soil),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.nitox.soil) +
xlab("italic(L.~terrestris)") +
ggtitle("Soil derived ", N[2],"O") +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
ggplot(gas15.cum, aes(x= Lt, y=nitox.soil),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.nitox.soil) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Soil derived ", N[2],"O"))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
ggplot(gas15.cum, aes(x= Lt, y=nitox),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.nitox) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Litter derived ", N[2], "O"))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
ggplot(gas15.cum, aes(x= Lt, y=nitox.soil),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.nitox.soil) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Soil derived ", N[2],"O"))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
ggplot(gas15.cum, aes(x= Lt, y=nitox.pool),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.pool) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Fraction of ",N[2],O[Litter]))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
p1 <- ggplot(gas15.cum, aes(x= Lt, y=nitox),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.nitox) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Litter derived ", N[2], "O"))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
p2 <- ggplot(gas15.cum, aes(x= Lt, y=nitox.soil),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.nitox.soil) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Soil derived ", N[2],"O"))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
p3 <- ggplot(gas15.cum, aes(x= Lt, y=nitox.pool),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.pool) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Fraction of ",N[2],O[Litter]))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
grid.newpage()
pushViewport(viewport(layout = grid.layout(3, 1)))
print(p1, vp = vplayout(1, 1))
print(p2, vp = vplayout(2, 1))
print(p3, vp = vplayout(3, 1))
gas15.cum$lsratio <- gas15.cum$nitox/gas15.cum$nitox.soil
hist(gas15.cum$ls.ratio, breaks=binsize1) # right skewed
hist(gas15.cum$lsratio, breaks=binsize1) # right skewed
gas15.omit <- gas15.cum[!(gas15.cum$soil=="Loam" & gas15.cum$Lt=="n"),]
binsize1 = sqrt(length(gas15.cum$product.ratio))
hist(gas15.cum$lsratio, breaks=binsize1) # right skewed
hist(asin(gas15.cum$lsratio/100)*2/pi, breaks=binsize1) # normalized
hist(gas15.cum$lsratio, breaks=binsize1) # right skewed
View(gas15.cum)
ggplot(gas15.cum, aes(x= Lt, y=lsratio),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.pool) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Fraction of ",N[2],O[Litter]))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
gas15.cum$lsratio <- gas15.cum$nitox/gas15.cum$nitox.gc
ggplot(gas15.cum, aes(x= Lt, y=lsratio),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.pool) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Fraction of ",N[2],O[Litter]))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
View(gas15.cum)
hist(gas15.cum$lsratio, breaks=binsize1) # right skewed
hist(asin(gas15.cum$lsratio/100)*2/pi, breaks=binsize1) # not normalized
hist(gas15.cum$lsratio, breaks=binsize1) # right skewed
gas15.lsr.aov <- aov(lsratio~soil*Lt*Fc, gas15.cum); summary(gas15.lsr.aov)
gas15.lsr.aov <- update(gas15.lsr.aov,.~soil*Lt, gas15.cum); summary(gas15.lsr.aov)
fligner.test(lsr.trans~interaction(soil,Lt), gas15.cum) # Heteroscedasticity!
fligner.test(lsratio~interaction(soil,Lt), gas15.cum) # Heteroscedasticity!
# Post Hoc Tukey Test
gas15.lsr.aov2 <- aov(lsr.trans~int.SLt, data=gas15.cum)
lsr.tuk <- glht(gas15.lsr.aov2, linfct = mcp(int.SLt = "Tukey"))
gas15.lsr.aov2 <- aov(lsratio~int.SLt, data=gas15.cum)
lsr.tuk <- glht(gas15.lsr.aov2, linfct = mcp(int.SLt = "Tukey"))
summary(lsr.tuk)          # standard display
lsr.tuk.cld <- cld(lsr.tuk)   # letter-based display
par(mai=c(1,1,1.1,0.2),  # mai specifies margin size in inches
mfrow=c(1,1),
mgp=c(2,1,0),
cex=0.8)
plot(lsr.tuk.cld, cex=0.5, las=2, col="grey", xaxt="n")
axis(1, at=int.SLt,labels=FALSE)
text(int.SLt, labels=int.SLt, par("usr")[3], adj=c(1.2,1.2), xpd=TRUE, srt=45, cex=0.8)
source("Data/GatherSOurce/V1_RequiredPackages.R")
source("Data/GatherSOurce/V1_Gather1.R") # load data including fig2.data!
source("Data/GatherSOurce/V1_Gather2.R") # N2O data processing
View(`n2o.bod`)
View(`n2o.cum`)
source("Data/GatherSOurce/V1_Gather3.R") # CO2 data processing
Cbind(n2o.index, n2o.bod[,c(2,8)], co2[,c(2,8)])
isom.dates <- cbind(n2o.index, n2o.bod[,c(2,8)], co2[,c(2,8)])
View(isom.dates)
isom.dates <- cbind(n2o.index, n2o.bod[,c(2,8)], co2.bod[,c(2,8)])
View(isom.dates)
?set.names()
?setnames()
colnames(isomdates)[6:9]
colnames(isom.dates)[6:9]
colnames(isom.dates)[6:9] <- c("n2o.day3","n2o.day21","co2.day3","co2.day21")
View(isom.dates)
aov(n2o.day3 ~ soil*Lt*Fc, isom.dates)
View(`n2o.index`)
View(`n2o.cum`)
View(ew.bm)
View(col.pop)
View(col.iso)
View(co2)
View(`n2o`)
View(`n2o.bod`)
View(`n2o`)
View(`n2o.btw`)
View(`n2o.ppb`)
56/4
Lt <- c(1,0,1,0)
Lt <- rep(Lt,14)
isom.dates$Lt <- Lt
View(isom.dates)
32/4
24/4
Lt <- rep(c(1,0),each=4,6)
Lt <- rep(c(1,0),each=4,4)
Lt <- rep(c(1,0),each=4,4)
Lt <- c(Lt, rep(c(1,0),each=3, 4)
)
isom.dates$Lt <- Lt
View(isom.dates)
Lt <- rep(c(1,1,0,0),each=4,2)
Lt <- c(Lt, rep(c(1,1,0,0),each=3, 2))
isom.dates$Lt <- Lt
Fc <- rep(c(0,1,1,0),each=4,2)
FC <- c(Fc, rep(c(0,1,1,0),each=3, 2))
isom.dates$Lt <- Lt
Lt <- rep(c(1,1,0,0),each=4,2)
Lt <- c(Lt, rep(c(1,1,0,0),each=3, 2))
isom.dates$Lt <- Lt
Fc <- rep(c(0,1,1,0),each=4,2)
FC <- c(Fc, rep(c(0,1,1,0),each=3, 2))
isom.dates$Fc <- Fc
Fc <- rep(c(0,1,1,0),each=4,2)
FC <- c(Fc, rep(c(0,1,1,0),each=3, 2))
isom.dates$Fc <- Fc
Fc <- rep(c(0,1,1,0),each=4,2)
FC <- c(Fc, rep(c(0,1,1,0),each=3, 2))
Fc <- rep(c(0,1,1,0),each=4,2)
Fc <- c(Fc, rep(c(0,1,1,0),each=3, 2))
isom.dates$Fc <- Fc
aov(n2o.day3 ~ soil*Lt*Fc, isom.dates)
aov(n2o.day3 ~ soil*Lt*Fc, isom.dates[experiment==exp2])
aov(n2o.day3 ~ soil*Lt*Fc, isom.dates[experiment==exp2,])
View(isom.dates)
aov(n2o.day3 ~ soil*Lt*Fc, isom.dates["experiment"==exp2,])
aov(n2o.day3 ~ soil*Lt*Fc, isom.dates["experiment"=="exp2",])
aov(n2o.day3 ~ soil*Lt*Fc, isom.dates[experiment=="exp2",])
aov(n2o.day3 ~ soil*Lt*Fc, isom.dates[.$experiment=="exp2",])
isom.dates[experiment=="exp2",]
isom.dates[,experiment]
isom.dates[,"experiment"]
aov(n2o.day3 ~ soil*Lt*Fc, isom.dates["experiment"=="exp2",])
aov(n2o.day3 ~ soil*Lt*Fc, isom.dates[,"experiment"=="exp2"])
aov(n2o.day3 ~ soil*Lt*Fc, isom.dates[,"experiment"==exp2])
isom.dates[,"experiment"=="exp2"]
isom.dates[,"experiment"==exp2]
isom.dates["experiment"== exp2,]
isom.dates["experiment"== "exp2",]
isom.dates["experiment"== 'exp2',]
isom.dates["experiment"]
isom.dates["experiment"==exp2]
isom.dates["experiment"=="exp2"]
isom.dates["experiment"]
isom.dates[,"experiment"]
isom.dates[,"experiment"=="exp2"]
isom.dates[,isom.dates$experiment=="exp2"]
isom.dates[isom.dates$experiment=="exp2",]
aov(n2o.day3 ~ soil*Lt*Fc, isom.dates[isom.dates$experiment=="exp2",])
isom.dates[.~"experiment"]
isom.dates["experiment"]==exp2
isom.dates["experiment"]=="exp2"
aov(n2o.day3 ~ soil*Lt*Fc, isom.dates["experiment"]=="exp2")
?subset
isom.dates[["experiment"]]
isom.dates[["experiment"==exp2]]
isom.dates[["experiment"=="exp2"]]
isom.dates["experiment"][1]
isom.dates["experiment"]["exp2"]
isom.dates["experiment"]["exp2",]
isom.dates["experiment"][exp2,]
isom.dates.exp2 <- isom.dates[isom.dates$experiment=="exp2",]
aov(n2o.day3 ~ soil*Lt*Fc, isom.dates.exp2)
aggregate(isom.dates.exp2,treat,mean)
aggregate(n2o.day3~treat,mean,isom.dates.exp2,)
aggregate(n2o.day3 ~ treat,isom.dates.exp2,mean)
n2o.day3.aov <- aov(n2o.day3 ~ soil*Lt*Fc, isom.dates.exp2); sumamry(n2o.day3.aov)
n2o.day3.aov <- aov(n2o.day3 ~ soil*Lt*Fc, isom.dates.exp2); summary(n2o.day3.aov)
n2o.day3.aov <- update(n2o.day3.aov(.~-soil:Lt:Fc); summary(n2o.day3.aov)
n2o.day3.aov <- update(n2o.day3.aov(.~ -soil:Lt:Fc)); summary(n2o.day3.aov)
n2o.day3.aov <- update(n2o.day3.aov, .~ -soil:Lt:Fc)); summary(n2o.day3.aov)
n2o.day3.aov <- update( .~ -soil:Lt:Fc, n2o.day3.aov); summary(n2o.day3.aov)
n2o.day3.aov <- update( n2o.day3.aov,.~ -soil:Lt:Fc, isom.dates.exp2); summary(n2o.day3.aov)
n2o.day3.aov <- aov(n2o.day3 ~ soil*Lt*Fc, isom.dates.exp2); summary(n2o.day3.aov)
n2o.day3.aov <- update( n2o.day3.aov,.~ -soil:Lt:Fc, isom.dates.exp2); summary(n2o.day3.aov)
n2o.day3.aov <- update( n2o.day3.aov,.~ - soil*Lt + soil*Fc, isom.dates.exp2); summary(n2o.day3.aov)
n2o.day3.aov <- update( n2o.day3.aov,.~ soil*Lt + soil*Fc, isom.dates.exp2); summary(n2o.day3.aov)
n2o.day3.aov <- update( n2o.day3.aov,.~ soil*Lt + soil*Fc + Lt*Fc, isom.dates.exp2); summary(n2o.day3.aov)
n2o.day3.aov <- update( n2o.day3.aov,.~ soil*Lt + soil*Fc, isom.dates.exp2); summary(n2o.day3.aov)
aggregate(n2o.day3 ~ treat+soil,isom.dates.exp2,mean)
n2o.day21.aov <- aov(n2o.day21 ~ soil*Lt*Fc, isom.dates.exp2); summary(n2o.day21.aov)
n2o.day21.aov <- update( n2o.day21.aov,.~ soil*Lt + soil*Fc, isom.dates.exp2); summary(n2o.day21.aov)
aggregate(n2o.day21 ~ treat+soil,isom.dates.exp2,mean)
aggregate(n2o.day21 ~ treat+soil,isom.dates.exp2,se)
a <- aggregate(n2o.day21 ~ treat+soil,isom.dates.exp2,mean)
b <- aggregate(n2o.day21 ~ treat+soil,isom.dates.exp2,se)
cbind(a,b[,3])
cbind(a,se=b[,3])
round(cbind(a,se=b[,3]),2)
round(cbind(a,se=b[,3])[,3,4],2)
n2o.day21 <- with(isom.dates.exp2, list( Mean=round(tapply(n2o.day21, list(treat,soil), mean),1),
SE=round(tapply(n2o.day21, list(treat,soil), se),1)))
data.frame(n2o.day21)[c(1,3,2,4)];rm(n2o.day21)
n2o.day3 <- with(isom.dates.exp2, list( Mean=round(tapply(n2o.day3, list(treat,soil), mean),1),
)
)
n2o.day3 <- with(isom.dates.exp2, list( Mean=round(tapply(n2o.day3, list(treat,soil), mean),1),
SE=round(tapply(n2o.day3, list(treat,soil), se),1)))
data.frame(n2o.day3)[c(1,3,2,4)];rm(n2o.day3)
co2.day3 <- with(isom.dates.exp2, list( Mean=round(tapply(co2.day3, list(treat,soil), mean),1),
SE=round(tapply(co2.day3, list(treat,soil), se),1)))
data.frame(co2.day3)[c(1,3,2,4)];rm(co2.day3)
co2.day21 <- with(isom.dates.exp2, list( Mean=round(tapply(co2.day21, list(treat,soil), mean),1),
SE=round(tapply(co2.day21, list(treat,soil), se),1)))
data.frame(co2.day21)[c(1,3,2,4)];rm(co2.day21)
co2.day3 <- with(isom.dates.exp2, list( Mean=round(tapply(co2.day3, list(treat,soil), mean),1)/100,
SE=round(tapply(co2.day3, list(treat,soil), se),1)))
data.frame(co2.day3)[c(1,3,2,4)];rm(co2.day3)
co2.day3 <- with(isom.dates.exp2, list( Mean=round(tapply(co2.day3, list(treat,soil), mean),1)/1000,
SE=round(tapply(co2.day3, list(treat,soil), se),1)))
data.frame(co2.day3)[c(1,3,2,4)];rm(co2.day3)
co2.day3 <- with(isom.dates.exp2, list( Mean=round(tapply(co2.day3, list(treat,soil), mean),1)/1000,
SE=round(tapply(co2.day3, list(treat,soil), se),1)/1000))
data.frame(co2.day3)[c(1,3,2,4)];rm(co2.day3)
co2.day3 <- with(isom.dates.exp2, list( Mean=round(tapply(co2.day3, list(treat,soil), mean)/1000,1),
SE=round(tapply(co2.day3, list(treat,soil), se)/1000,1)))
data.frame(co2.day3)[c(1,3,2,4)];rm(co2.day3)
co2.day21 <- with(isom.dates.exp2, list( Mean=round(tapply(co2.day21, list(treat,soil)/1000, mean),1),
SE=round(tapply(co2.day21, list(treat,soil)/1000, se),1)))
data.frame(co2.day21)[c(1,3,2,4)];rm(co2.day21)
co2.day21 <- with(isom.dates.exp2, list( Mean=round(tapply(co2.day21, list(treat,soil)/1000, mean),1),
SE=round(tapply(co2.day21, list(treat,soil)/1000, se),1)))
data.frame(co2.day21)[c(1,3,2,4)];rm(co2.day21)
co2.day3 <- with(isom.dates.exp2, list( Mean=round(tapply(co2.day3, list(treat,soil), mean)/1000,1),
SE=round(tapply(co2.day3, list(treat,soil), se)/1000,1)))
data.frame(co2.day3)[c(1,3,2,4)];rm(co2.day3)
co2.day21 <- with(isom.dates.exp2, list( Mean=round(tapply(co2.day21, list(treat,soil)/1000, mean),1),
SE=round(tapply(co2.day21, list(treat,soil)/1000, se),1)))
data.frame(co2.day21)[c(1,3,2,4)];rm(co2.day21)
co2.day3 <- with(isom.dates.exp2, list( Mean=round(tapply(co2.day3, list(treat,soil), mean)/1000,1),
SE=round(tapply(co2.day3, list(treat,soil), se)/1000,1)))
data.frame(co2.day3)[c(1,3,2,4)];rm(co2.day3)
co2.day21 <- with(isom.dates.exp2, list( Mean=round(tapply(co2.day21, list(treat,soil), mean)/1000,1),
SE=round(tapply(co2.day21, list(treat,soil), se)/1000,1)))
data.frame(co2.day21)[c(1,3,2,4)];rm(co2.day21)
n2o.day3.aov <- aov(n2o.day3 ~ soil*Lt*Fc, isom.dates.exp2); summary(n2o.day3.aov)
n2o.day3.aov <- update( n2o.day3.aov,.~ soil*Lt + soil*Fc, isom.dates.exp2); summary(n2o.day3.aov)
n2o.day3.aov <- update( n2o.day3.aov,.~ - soil:Lt:Fc, isom.dates.exp2); summary(n2o.day3.aov)
plot(n2o.day3.aov)
par(mfrow=c(2,2))
plot(n2o.day3.aov)
n2o.day3.aov <- update( n2o.day3.aov,.~ soil*Lt + soil*Fc, isom.dates.exp2); summary(n2o.day3.aov)
par(mfrow=c(2,2))
plot(n2o.day3.aov)
n2o.day3.aov <- update( n2o.day3.aov,log(.)~ soil*Lt + soil*Fc, isom.dates.exp2); summary(n2o.day3.aov)
par(mfrow=c(2,2))
plot(n2o.day3.aov)
n2o.day3.aov <- update( n2o.day3.aov,log(.)~ soil*treat, isom.dates.exp2); summary(n2o.day3.aov)
n2o.day3.aov <- update( n2o.day3.aov,log1p(.)~ soil*treat, isom.dates.exp2); summary(n2o.day3.aov)
n2o.day3.aov <- aov(n2o.day3 ~ soil*Lt*Fc, isom.dates.exp2); summary(n2o.day3.aov)
n2o.day3.aov <- update( n2o.day3.aov,log1p(.)~ soil*treat, isom.dates.exp2); summary(n2o.day3.aov)
n2o.day3.aov <- aov(n2o.day3 ~ soil*Lt*Fc, isom.dates.exp2); summary(n2o.day3.aov)
n2o.day3.aov <- update( n2o.day3.aov,log(.)~ soil*treat, isom.dates.exp2); summary(n2o.day3.aov)
par(mfrow=c(2,2))
plot(n2o.day3.aov)
n2o.day3.aov <- aov(n2o.day3 ~ soil*Lt*Fc, isom.dates.exp2); summary(n2o.day3.aov)
isom.dates$int <- with(isom.dates, interaction(soil. Lt))
isom.dates$int <- with(isom.dates, interaction(soil, Lt))
n2o.day3.aov2 <- update(n2o.day3.aov, .~ . + int - soil*Lt)
isom.dates$int <- with(isom.dates, interaction(soil, Lt))
n2o.day3.aov2 <- update(n2o.day3.aov, .~ . + int - soil*Lt)
n2o.day3.aov2 <- update(n2o.day3.aov, .~ . + int - soil*Lt, isom.dates.exp2)
isom.dates.exp2 <- isom.dates[isom.dates$experiment=="exp2",]
n2o.day3.aov2 <- update(n2o.day3.aov, .~ . + int - soil*Lt, isom.dates.exp2)
dn.tuk <- glht(n2o.day3.aov2, linfct = mcp(int = "Tukey"))
summary(dn.tuk)          # standard display
isom.dates$int <- with(isom.dates, interaction(soil, treat))
isom.dates.exp2 <- isom.dates[isom.dates$experiment=="exp2",]
n2o.day3.aov <- aov(n2o.day3 ~ soil*Lt*Fc, isom.dates.exp2); summary(n2o.day3.aov)
n2o.day3.aov <- update( n2o.day3.aov,log(.)~ soil*treat, isom.dates.exp2); summary(n2o.day3.aov)
par(mfrow=c(2,2))
plot(n2o.day3.aov)
# Post Hoc Tukey Test
n2o.day3.aov2 <- update(n2o.day3.aov, .~ int, isom.dates.exp2)
dn.tuk <- glht(n2o.day3.aov2, linfct = mcp(int = "Tukey"))
summary(dn.tuk)          # standard display
dn.tuk.cld <- cld(dn.tuk)   # letter-based display
dn.tuk.cld
n2o.day21.aov <- aov(n2o.day21 ~ soil*Lt*Fc, isom.dates.exp2); summary(n2o.day21.aov)
n2o.day21.aov <- update( n2o.day21.aov,.~ soil*Lt, isom.dates.exp2); summary(n2o.day21.aov)
n2o.day21.aov <- update( n2o.day21.aov,.~ soil*treat, isom.dates.exp2); summary(n2o.day21.aov)
n2o.day21.aov <- update( n2o.day21.aov,.~ int, isom.dates.exp2); summary(n2o.day21.aov)
dn.tuk <- glht(n2o.day21.aov2, linfct = mcp(int = "Tukey"))
n2o.day21.aov2 <- update( n2o.day21.aov,.~ int, isom.dates.exp2); summary(n2o.day21.aov)
dn.tuk <- glht(n2o.day21.aov2, linfct = mcp(int = "Tukey"))
summary(dn.tuk)          # standard display
n2o.day21.aov <- aov(n2o.day21 ~ soil*Lt*Fc, isom.dates.exp2); summary(n2o.day21.aov)
n2o.day21.aov <- update( n2o.day21.aov,.~ soil*treat, isom.dates.exp2); summary(n2o.day21.aov)
par(mfrow=c(2,2))
plot(n2o.day21.aov)
n2o.day21.aov <- update( n2o.day21.aov,log(.)~ soil*treat, isom.dates.exp2); summary(n2o.day21.aov)
par(mfrow=c(2,2))
plot(n2o.day21.aov)
n2o.day21.aov2 <- update( n2o.day21.aov,.~ int, isom.dates.exp2); summary(n2o.day21.aov)
dn.tuk <- glht(n2o.day21.aov2, linfct = mcp(int = "Tukey"))
summary(dn.tuk)          # standard display
dn.tuk.cld <- cld(dn.tuk)   # letter-based display
dn.tuk.cld
co2.day21.aov <- aov(co2.day21 ~ soil*Lt*Fc, isom.dates.exp2); summary(co2.day21.aov)
co2.day21.aov <- update( co2.day21.aov,log(.)~ soil*treat, isom.dates.exp2); summary(co2.day21.aov)
par(mfrow=c(2,2))
plot(co2.day21.aov)
co2.day21.aov2 <- update( co2.day21.aov,.~ int, isom.dates.exp2); summary(co2.day21.aov)
dn.tuk <- glht(co2.day21.aov2, linfct = mcp(int = "Tukey"))
summary(dn.tuk)          # standard display
dn.tuk.cld <- cld(dn.tuk)   # letter-based display
dn.tuk.cld
co2.day3.aov <- aov(co2.day3 ~ soil*Lt*Fc, isom.dates.exp2); summary(co2.day3.aov)
co2.day3.aov <- update( co2.day3.aov,log(.)~ soil*treat, isom.dates.exp2); summary(co2.day3.aov)
par(mfrow=c(2,2))
plot(co2.day3.aov)
co2.day3.aov2 <- update( co2.day3.aov,.~ int, isom.dates.exp2); summary(co2.day3.aov)
dn.tuk <- glht(co2.day3.aov2, linfct = mcp(int = "Tukey"))
summary(dn.tuk)          # standard display
dn.tuk.cld <- cld(dn.tuk)   # letter-based display
dn.tuk.cld
View(co2.bod)
source("Data/GatherSOurce/V1_RequiredPackages.R")
source("Data/GatherSOurce/V1_Gather1.R") # load data including fig2.data!
source("Data/GatherSOurce/V1_Gather2.R") # N2O data processing
source("Data/GatherSOurce/V1_Gather3.R") # CO2 data processing
isom.dates <- cbind(n2o.index, n2o.bod[,c(2,8)], co2.bod[,c(2,8)])
colnames(isom.dates)[6:9] <- c("n2o.day3","n2o.day21","co2.day3","co2.day21")
# ANOVA Analysis
Lt <- rep(c(1,1,0,0),each=4,2)
Lt <- c(Lt, rep(c(1,1,0,0),each=3, 2))
isom.dates$Lt <- Lt
Fc <- rep(c(0,1,1,0),each=4,2)
Fc <- c(Fc, rep(c(0,1,1,0),each=3, 2))
isom.dates$Fc <- Fc
isom.dates$int <- with(isom.dates, interaction(soil, treat))
isom.dates.exp2 <- isom.dates[isom.dates$experiment=="exp2",]
co2.day21 <- with(isom.dates.exp2, list( Mean=round(tapply(co2.day21, list(treat,soil), mean)/1000,1),
SE=round(tapply(co2.day21, list(treat,soil), se)/1000,1)))
data.frame(co2.day21)[c(1,3,2,4)];rm(co2.day21)
co2.day21 <- with(isom.dates.exp2, list( Mean=round(tapply(co2.day21, list(treat,soil), mean),1),
SE=round(tapply(co2.day21, list(treat,soil), se),1)))
data.frame(co2.day21)[c(1,3,2,4)];rm(co2.day21)
co2.day3.aov <- aov(co2.day3 ~ soil*Lt*Fc, isom.dates.exp2); summary(co2.day3.aov)
co2.day3.aov <- update( co2.day3.aov,log(.)~ soil+Lt+Fc, isom.dates.exp2); summary(co2.day3.aov)
n2o.day3.aov <- aov(n2o.day3 ~ soil*Lt*Fc, isom.dates.exp2); summary(n2o.day3.aov)
n2o.day3.aov <- aov(n2o.day3 ~ soil*Lt + soil*Fc, isom.dates.exp2); summary(n2o.day3.aov)
n2o.day21.aov <- aov(n2o.day21 ~ soil*Lt*Fc, isom.dates.exp2); summary(n2o.day21.aov)
n2o.day21.aov <- aov(n2o.day21 ~ soil*Lt, isom.dates.exp2); summary(n2o.day21.aov)
co2.day21.aov <- aov(co2.day21 ~ soil*Lt*Fc, isom.dates.exp2); summary(co2.day21.aov)
co2.day21.aov <- aov(co2.day21 ~ soil+Lt+Fc, isom.dates.exp2); summary(co2.day21.aov)
