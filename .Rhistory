facet_grid(.~soil, labeller=label_parsed) +
mytheme
ggplot(gas15.cum, aes(x= Lt, y=nitox.gc),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(expression(paste("total.nitox.cum"))) +
xlab("L.~terrestris") +
facet_grid(.~soil, labeller=label_parsed) +
mytheme
ggplot(gas15.cum, aes(x= Lt, y=total),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.total) +
xlab("L.~terrestris") +
facet_grid(.~soil, labeller=label_parsed) +
mytheme
gas15.$nitox.pool <- as.numeric(with(gas15, tapply(nitox.pool,MK,mean)))
gas15.$product.ratio <- as.numeric(with(gas15.data, tapply(product.ratio,MK,mean)))
gas15.cum$nitox.pool <- as.numeric(with(gas15, tapply(nitox.pool,MK,mean)))
gas15.cum$product.ratio <- as.numeric(with(gas15, tapply(product.ratio,MK,mean)))
hist(gas15.cum$product.ratio)
ggplot(gas15.cum, aes(x= Lt, y=product.ratio),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(expression(paste("product ratio"))) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Product Ratio"))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
hist(gas15.cum$product.ratio)
binsize1 = sqrt(length(gas15.cum$product.ratio))
hist(gas15.cum$product.ratio, breaks=binsize1)
ggplot(gas15.cum, aes(x= Lt, y=product.ratio),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(expression(paste("product ratio"))) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Product Ratio"))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
hist(asin(sqrt(product.ratio))*180/pi, breaks=binsize1) # right skewed
hist(asin(sqrt(gas15.cum$product.ratio))*180/pi, breaks=binsize1) # right skewed
x <- gas15.cum$product.ratio
asin(sqrt(x))*180/pi
asin(sqrt(x))*180/pi
asin(x/100)
asin(x/100)*2/pi #if you want the results rescaled to (0,1)
curve(asin(x/100)*2/pi,from=0,to=100)
curve(b,from=0,to=100)
x <- gas15.cum$product.ratio
a = asin(sqrt(x))*180/pi
b = asin(x/100)
c = asin(x/100)*2/pi #if you want the results rescaled to (0,1)
curve(a,from=0,to=100)
curve(b,from=0,to=100)
curve(c,from=0,to=100)
curve(a,from=0,to=100)
x <- gas15.cum$product.ratio
a = asin(sqrt(x))*180/pi
b = asin(x/100)
c = asin(x/100)*2/pi #if you want the results rescaled to (0,1)
curve(a,from=0,to=100)
curve(b,from=0,to=100)
curve(c,from=0,to=100)
curve(asin(sqrt(x))*180/pi,from=0,to=100)
asin(sqrt(x)
)
curve(a)
curve(asin(sqrt(x))*180/pi)
curve(asin(x/100))
curve(asin(x/100)*2/pi)
curve(asin(x/100)*2/pi, from=0,to=100)
curve(asin(x/100),from=0,to=100)
curve(asin(x/100)*2/pi, from=0,to=100)
curve(asin(sqrt(x))*180/pi)
a = asin(sqrt(0))*180/pi
curve(asin(sqrt(x))*180/pi, to=100)
curve(asin(sqrt(x))*180/pi)
curve(asin(x/100),from=0,to=100)
curve(asin(x/100)*2/pi, from=0,to=100)
hist(a, breaks=binsize1) # normalized
hist(b, breaks=binsize1) # normalized
hist(c, breaks=binsize1) # normalized
x <- gas15.cum$product.ratio
a = asin(sqrt(x))*180/pi
b = asin(x/100)
c = asin(x/100)*2/pi #if you want the results rescaled to (0,1)
hist(a, breaks=binsize1) # normalized
hist(b, breaks=binsize1) # normalized
hist(c, breaks=binsize1) # normalized
hist(asin(gas15.cum$product.ratio/100)*2/pi, breaks=binsize1) # normalized
gas15.cum$trens.pr <- asin(gas15.cum$product.ratio/100)*2/pi
gas15.pr.aov <- aov(trans.pr~soil*Lt*Fc, gas15.cum); summary(gas15.pr.aov)
gas15.cum$trans.pr <- asin(gas15.cum$product.ratio/100)*2/pi
gas15.pr.aov <- aov(trans.pr~soil*Lt*Fc, gas15.cum); summary(gas15.pr.aov)
ggplot(gas15.cum, aes(x= Lt, y=product.ratio),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(expression(paste("product ratio"))) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Product Ratio"))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
gas15.pr.aov <- aov(product.ratio~soil*Lt*Fc, gas15.cum); summary(gas15.pr.aov)
gas15.cum$trans.pr <- asin(gas15.cum$product.ratio/100)*2/pi
gas15.pr.aov <- aov(trans.pr~soil*Lt*Fc, gas15.cum); summary(gas15.pr.aov)
View(gas15.cum)
glm(gas15.cum, product.ratio~soil*Lt*Fc, family=binomial)
glm(product.ratio~soil*Lt*Fc, family=binomial, gas15.cum)
summary(glm)
glm1  <- glm(product.ratio~soil*Lt*Fc, family=binomial, gas15.cum)
summary(glm1)
glm1  <- glm(product.ratio~soil*Lt*Fc, weight=total, family=binomial, gas15.cum)
par(mfrow=c(2,2))
par(mar=c(3,3,3,3))
plot(gas15.pr.aov)
gas15.pr.aov <- aov(product.ratio~soil*Lt*Fc, gas15.cum); summary(gas15.pr.aov)
par(mfrow=c(2,2))
par(mar=c(3,3,3,3))
plot(gas15.pr.aov)
gas15.cum$trans.pr <- asin(gas15.cum$product.ratio/100)*2/pi
gas15.pr.aov <- aov(trans.pr~soil*Lt*Fc, gas15.cum); summary(gas15.pr.aov)
par(mfrow=c(2,2))
par(mar=c(3,3,3,3))
plot(gas15.pr.aov)
gas15.cum$trans.pr <- asin(sqrt(product.ratio))*180/pi
gas15.cum$trans.pr <- asin(gas15.cum$sqrt(product.ratio))*180/pi
gas15.cum$trans.pr <- asin(sqrt(gas15.cum$product.ratio))*180/pi
gas15.pr.aov <- aov(trans.pr~soil*Lt*Fc, gas15.cum); summary(gas15.pr.aov)
par(mfrow=c(2,2))
par(mar=c(3,3,3,3))
plot(gas15.pr.aov)
fligner.test(trans.pr~soil*Lt*Fc, gas15.cum)
?fligner.test
fligner.test(trans.pr ~ interaction(soil*Lt*Fc), gas15.cum)
fligner.test(trans.pr ~ interaction(soil,Lt,Fc), gas15.cum)
TukeyHSD(gas15.pr.aov)
with(gas15.cum, shapiro.test(trans.pr)) # if this Test is significant, the data is significantly different from Normal sitribution and the ANOVA assumption is violated
gas15.pr.aov <- update(gas15.pr.aov, .~soil*Lt);summary(gas15.pr.aov)
# validation plot
par(mfrow=c(2,2))
plot(gas15.pr.aov)
int.SLt <- with(gas15.cum, interaction(soil,Lt)) # Double interaction factor
gas15.pr.aov2 <- aov(trans.pr~int.SLt, data=gas15.cum)
HSD.test(gas15.pr.aov2, "prodr.int", group=TRUE, console=TRUE)
summary(HSD.test(gas15.pr.aov2, "prodr.int", group=TRUE, console=TRUE))
?HSD.test
out <- HSD.test(gas15.pr.aov2, "prodr.int", group=TRUE, console=TRUE)
bar.group(out$groups,ylim=c(0,45),density=4,border="blue")
out$groups
data(sweetpotato)
model<-aov(yield~virus, data=sweetpotato)
out <- HSD.test(model,"virus", group=TRUE,console=TRUE,
main="Yield of sweetpotato\nDealt with different virus")
#stargraph
bar.group(out$groups,ylim=c(0,45),density=4,border="blue")
#endgraph
out<-HSD.test(model,"virus", group=FALSE)
means<-out$means
gas.cum$int.SLt <- with(gas15.cum, interaction(soil,Lt)) # Double interaction factor
gas15.cum$int.SLt <- with(gas15.cum, interaction(soil,Lt)) # Double interaction factor
gas15.pr.aov2 <- aov(trans.pr~int.SLt, data=gas15.cum)
out <- HSD.test(gas15.pr.aov2, "prodr.int", group=TRUE, console=TRUE)
View(sweetpotato)
gas15.cum$int.SLt <- with(gas15.cum, interaction(soil,Lt)) # Double interaction factor
gas15.pr.aov2 <- aov(trans.pr~int.SLt, data=gas15.cum)
out <- HSD.test(gas15.pr.aov2, "prodr.int", group=TRUE, console=TRUE)
data(sweetpotato)
model<-aov(yield~virus, data=sweetpotato)
out <- HSD.test(model,"virus", group=TRUE,console=TRUE,
main="Yield of sweetpotato\nDealt with different virus")
out <- HSD.test(gas15.pr.aov2, "prodr.int", group=TRUE, console=TRUE, main="balbla")
model <- aov(trans.pr~int.SLt, data=gas15.cum)
out <- HSD.test(model, "prodr.int", group=TRUE, console=TRUE, main="balbla")
str(gas15.cum)
str(sweetpotato)
pr.tuk1 <- glht(gas15.pr.aov2, linfct = mcp(int.SLt = "Tukey"))
summary(pr.tuk1)          # standard display
pr.tuk.cld <- cld(pr.tuk)   # letter-based display
pr.tuk <- glht(gas15.pr.aov2, linfct = mcp(int.SLt = "Tukey"))
summary(pr.tuk)          # standard display
pr.tuk.cld <- cld(pr.tuk)   # letter-based display
par(mai=c(1,1,1.1,0.2),  # mai specifies margin size in inches
mfrow=c(1,1),
mgp=c(2,1,0),
cex=0.8)
plot(pr.tuk.cld, cex=0.5, las=2, col="grey", xaxt="n")
axis(1, at=pr.int,labels=FALSE)
axis(1, at=int.SLt,labels=FALSE)
text(int.SLt, labels=pr.int, par("usr")[3], adj=c(1.2,1.2), xpd=TRUE, srt=45, cex=0.8)
text(int.SLt, labels=int.SLt, par("usr")[3], adj=c(1.2,1.2), xpd=TRUE, srt=45, cex=0.8)
gas15.pr.aov3 <- aov(asin(pr.trans~soil*Lt,gas15.cum.omit);summary(gas15.pr.aov3)
gas15.pr.aov3 <- aov(asin(pr.trans~soil*Lt,gas15.cum.omit);summary(gas15.pr.aov3)
gas15.pr.aov3 <- aov(pr.trans~soil*Lt,gas15.cum.omit) ;summary(gas15.pr.aov3)
gas15.omit <- gas15.cum[!(gas15.data$soil=="Loam"&gas15.data$Lt=="n"),]
gas15.omit <- gas15.cum[!(gas15.cum$soil=="Loam" & gas15.cum$Lt=="n"),]
gas15.pr.aov3 <- aov(pr.trans~soil*Lt,gas15.omit) ;summary(gas15.pr.aov3)
fligner.test(pr.trans~interaction(soil,Lt), gas15.cum)
gas15.cum$pr.trans <- asin(sqrt(gas15.cum$product.ratio))*180/pi
gas15.pr.aov <- aov(pr.trans~soil*Lt*Fc, gas15.cum); summary(gas15.pr.aov)
fligner.test(pr.trans~interaction(soil,Lt), gas15.cum)
gas15.pr.aov3 <- aov(pr.trans~soil*Lt,gas15.omit) ;summary(gas15.pr.aov3)
gas15.omit$pr.trans <- asin(sqrt(gas15.cum$product.ratio))*180/pi
gas15.omit$pr.trans <- asin(sqrt(gas15.omit$product.ratio))*180/pi
gas15.pr.aov3 <- aov(pr.trans~soil*Lt,gas15.) ;summary(gas15.pr.aov3)
gas15.pr.aov3 <- aov(pr.trans~soil*Lt,gas15.omit) ;summary(gas15.pr.aov3)
ggplot(gas15.cum, aes(x= Lt, y=product.ratio),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(expression(paste("product ratio"))) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Product Ratio"))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
ggplot(gas15.cum, aes(x= soil, y=product.ratio),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(expression(paste("product ratio"))) +
xlab("Soil") +
ggtitle(expression(paste("Product Ratio"))) +
facet_grid(~Lt, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("Loam","Sand")) +
mytheme
with(gas15.cum, list(round(tapply(product.ratio,interaction(Lt,soil), mean),2),
round(tapply(product.ratio,interaction(Lt,soil), se),2))
with(gas15.cum, list(round(tapply(product.ratio,interaction(Lt,soil), mean),2),
round(tapply(product.ratio,interaction(Lt,soil), se),2)))
ggplot(gas15.cum, aes(x= Lt, y=pr.trans),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(expression(paste("product ratio"))) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Product Ratio"))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
gas15.nx.aov <- aov(nitox~soil*Lt*Fc, gas15.cum); summary(gas15.nx.aov)
hist(nitox, gas15.cum)
hist(gas15.cum$nitox)
hist(gas15.cum$nitox, breaks=binsize1)
gas15.nx.aov <- aov(nitox~soil*Lt*Fc, gas15.cum); summary(gas15.nx.aov)
par(mfrow=c(2,2))
par(mar=c(3,3,3,3))
plot(gas15.nx.aov)
gas15.nx.aov <- aov(log1p(nitox)~soil*Lt*Fc, gas15.cum); summary(gas15.nx.aov)
gas15.nx.aov <- update(gas15.nx.aov,.~soil*Lt, gas15.cum); summary(gas15.nx.aov)
par(mfrow=c(2,2))
par(mar=c(3,3,3,3))
plot(gas15.nx.aov)
fligner.test(log1p(nitox)~interaction(soil,Lt), gas15.cum)
ggplot(gas15.cum, aes(x= Lt, y=nitox),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(expression(paste("product ratio"))) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Product Ratio"))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
ggplot(gas15.cum, aes(x= Lt, y=nitox),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(expression(paste("Litter derived N2O"))) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Product Ratio"))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
gas15.nx.aov2 <- update(gas15.nx.aov, .~ int.SLt)
nx.tuk <- glht(gas15.nx.aov2, linfct = mcp(int.SLt = "Tukey"))
summary(nx.tuk)          # standard display
nx.tuk.cld <- cld(nx.tuk)   # letter-based display
par(mai=c(1,1,1.1,0.2),  # mai specifies margin size in inches
mfrow=c(1,1),
mgp=c(2,1,0),
cex=0.8)
plot(nx.tuk.cld, cex=0.5, las=2, col="grey", xaxt="n")
axis(1, at=int.SLt,labels=FALSE)
text(int.SLt, labels=int.SLt, par("usr")[3], adj=c(1.2,1.2), xpd=TRUE, srt=45, cex=0.8)
gas15.nx.aov <- aov(log1p(nitox)~soil*Lt, gas15.omit); summary(gas15.nx.aov)
with(gas15.omit[(gas15.omit$Lt=="y"),], t.test(log1p(nitox)~soil, alternative="less"))
expm1(5.335476)
with(gas15.cum, list( tapply(nitox, list(Lt,soil), mean),
tapply(nitox, list(Lt,soil), se)))
expm1(5.335476)
with(gas15.cum, list( tapply(nitox, soil, mean),
tapply(nitox, soil, se)))
with(gas15.omit[(gas15.omit$Lt=="y"),], t.test(log1p(nitox)~soil, alternative="less"))
summary(nx.tuk)          # standard display
fitted(gas15.nx.aov)
expm1(fitted(gas15.nx.aov))
boxplot(expm1(fitted(gas15.nx.aov)))
boxplot(expm1(fitted(gas15.nx.aov))~gas15.cum$int.SLt)
gas15.cum$int.SLt
gas15.nx.aov2 <- update(gas15.nx.aov, .~ int.SLt)
gas15.nx.aov <- aov(log1p(nitox)~soil*Lt*Fc, gas15.cum); summary(gas15.nx.aov)
gas15.nx.aov <- update(gas15.nx.aov,.~soil*Lt, gas15.cum); summary(gas15.nx.aov)
gas15.nx.aov2 <- update(gas15.nx.aov, .~ int.SLt)
boxplot(expm1(fitted(gas15.nx.aov))~gas15.cum$int.SLt)
hist(gas15.cum$dinitrogen, breaks=binsize1)
ggplot(gas15.cum, aes(x= Lt, y=dinitrogen),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(expression(paste("product ratio"))) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Product Ratio"))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
ggplot(gas15.cum, aes(x= soil, y=dinitrogen),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(expression(paste("product ratio"))) +
xlab("Soil") +
ggtitle(expression(paste("Product Ratio"))) +
facet_grid(~Lt, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("Loam","Sand")) +
mytheme
gas15.dn.aov <- update(gas15.dn.aov,.~soil*Lt, gas15.cum); summary(gas15.dn.aov)
gas15.dn.aov <- aov(log1p(dinitrogen)~soil*Lt*Fc, gas15.cum); summary(gas15.dn.aov)
gas15.dn.aov <- update(gas15.dn.aov,.~soil*Lt, gas15.cum); summary(gas15.dn.aov)
par(mfrow=c(2,2))
par(mar=c(3,3,3,3))
plot(gas15.dn.aov)
fligner.test(log1p(dinitrogen)~interaction(soil,Lt), gas15.cum) # Heteroscedasticity!
gas15.dn.aov2 <- update(gas15.dn.aov, .~ int.SLt)
dn.tuk <- glht(gas15.dn.aov2, linfct = mcp(int.SLt = "Tukey"))
summary(dn.tuk)          # standard display
n.tuk <- glht(gas15.dn.aov2, linfct = mcp(int.SLt = "Tukey"))
summary(dn.tuk)          # standard display
dn.tuk.cld <- cld(dn.tuk)   # letter-based display
par(mai=c(1,1,1.1,0.2),  # mai specifies margin size in inches
mfrow=c(1,1),
mgp=c(2,1,0),
cex=0.8)
plot(dn.tuk.cld, cex=0.5, las=2, col="grey", xaxt="n")
axis(1, at=int.SLt,labels=FALSE)
text(int.SLt, labels=int.SLt, par("usr")[3], adj=c(1.2,1.2), xpd=TRUE, srt=45, cex=0.8)
gas15.cum$np.trans <- asin(sqrt(nitox.pool))*180/pi
gas15.cum$np.trans <- asin(sqrt(gas15.cum$nitox.pool))*180/pi
gas15.np.aov <- aov(np.trans~soil*Lt*Fc, gas15.cum); summary(gas15.np.aov)
fligner.test(np.trans~interaction(soil,Lt), gas15.cum)
gas15.np.aov2 <- aov(np.trans~int.SLt, data=gas15.cum)
np.tuk <- glht(gas15.np.aov2, linfct = mcp(int.SLt = "Tukey"))
summary(np.tuk)          # standard display
ggplot(gas15.cum, aes(x= Lt, y=nitox.pool),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(expression(paste("Fraction~of~",N[2],O[Litter]))) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("nitox.pool"))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
ggplot(gas15.cum, aes(x= Lt, y=nitox.pool),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(expression(paste("Fraction of ",N[2],O[Litter]))) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Fraction of ",N[2],O[Litter]))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
ggplot(gas15.cum, aes(x= Lt, y=product.ratio),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.product.ratio) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Product Ratio"))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
txt.pool = expression(paste("Plant derived ", N[2],"O"," [%]"))
txt.nitox = expression(paste(N[2],"O"[litter]," [µg ",N[2],"O-N ",kg^-1, h^-1,"]"))
txt.nitox.gc = expression(paste(N[2],"O"[total]," [µg ",N[2],"O-N ",kg^-1, h^-1,"]"))
txt.total      = expression(paste("Total ", N[2],"O+",N[2]," [µg ",N[2],"(O)-N ",kg^-1, h^-1,"]"))
txt.dinitrogen = expression(paste("Dinitrogen ", N[2]," [µg ",N[2],"-N ",kg^-1, h^-1,"]"))
txt.ratio      = expression(paste("Product Ratio ", frac(paste(N[2],O),paste(N[2],O+N[2]))))
ggplot(gas15.cum, aes(x= Lt, y=product.ratio),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.ratio) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Product Ratio"))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
ggplot(gas15.cum, aes(x= soil, y=product.ratio),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.ratio) +
xlab("Soil") +
ggtitle(expression(paste("Product Ratio"))) +
facet_grid(~Lt, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("Loam","Sand")) +
mytheme
hist(gas15.cum$total, breaks=binsize1)
ggplot(gas15.cum, aes(x= Lt, y=total),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(expression(paste("product ratio"))) +
xlab("italic(L.~terrestris)") +
ggtitle(expression(paste("Product Ratio"))) +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
gas15.tot.aov <- aov(total~soil*Lt*Fc, gas15.cum); summary(gas15.tot.aov)
gas15.tot.aov <- aov(log1p(total)~soil*Lt*Fc, gas15.cum); summary(gas15.tot.aov)
gas15.tot.aov <- update(gas15.tot.aov,.~soil*Lt, gas15.cum); summary(gas15.tot.aov)
par(mfrow=c(2,2))
par(mar=c(3,3,3,3))
plot(gas15.tot.aov)
tot.tuk <- glht(gas15.tot.aov2, linfct = mcp(int.SLt = "Tukey"))
summary(tot.tuk)          # standard display
tot.tuk.cld <- cld(tot.tuk)   # letter-based display
par(mai=c(1,1,1.1,0.2),  # mai specifies margin size in inches
mfrow=c(1,1),
mgp=c(2,1,0),
cex=0.8)
plot(tot.tuk.cld, cex=0.5, las=2, col="grey", xaxt="n")
axis(1, at=int.SLt,labels=FALSE)
text(int.SLt, labels=int.SLt, par("usr")[3], adj=c(1.2,1.2), xpd=TRUE, srt=45, cex=0.8)
gas15.tot.aov2 <- update(gas15.tot.aov, .~ int.SLt)
tot.tuk <- glht(gas15.tot.aov2, linfct = mcp(int.SLt = "Tukey"))
summary(tot.tuk)          # standard display
tot.tuk.cld <- cld(tot.tuk)   # letter-based display
par(mai=c(1,1,1.1,0.2),  # mai specifies margin size in inches
mfrow=c(1,1),
mgp=c(2,1,0),
cex=0.8)
plot(tot.tuk.cld, cex=0.5, las=2, col="grey", xaxt="n")
axis(1, at=int.SLt,labels=FALSE)
text(int.SLt, labels=int.SLt, par("usr")[3], adj=c(1.2,1.2), xpd=TRUE, srt=45, cex=0.8)
ggplot(gas15.cum, aes(x= Lt, y=nitox.gc),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.nitox.gc) +
xlab("italic(L.~terrestris)") +
ggtitle("Total N2O") +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
gas15.nxt.aov <- aov(nitox.gc~soil*Lt*Fc, gas15.cum); summary(gas15.nxt.aov)
gas15.nxt.aov <- aov(log1p(nitox.gc)~soil*Lt*Fc, gas15.cum); summary(gas15.nxt.aov)
gas15.nxt.aov <- update(gas15.nxt.aov,.~soil*Lt, gas15.cum); summary(gas15.nxt.aov)
par(mfrow=c(2,2))
par(mar=c(3,3,3,3))
plot(gas15.nxt.aov)
fligner.test(log1p(nitox.gc)~interaction(soil,Lt), gas15.cum) # Heteroscedasticity!
gas15.nxt.aov2 <- update(gas15.nxt.aov, .~ int.SLt)
nxt.tuk <- glht(gas15.nxt.aov2, linfct = mcp(int.SLt = "Tukey"))
summary(nxt.tuk)          # standard display
nxt.tuk.cld <- cld(nxt.tuk)   # letter-based display
par(mai=c(1,1,1.1,0.2),  # mai specifies margin size in inches
mfrow=c(1,1),
mgp=c(2,1,0),
cex=0.8)
plot(nxt.tuk.cld, cex=0.5, las=2, col="grey", xaxt="n")
ggplot(gas15.cum, aes(x= Lt, y=dinitrogen),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.dinitrogen) +
xlab("italic(L.~terrestris)") +
ggtitle("Litter derived N2") +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
fligner.test(log1p(dinitrogen)~interaction(soil,Lt), gas15.cum) # Heteroscedasticity!
fligner.test(np.trans~interaction(soil,Lt), gas15.cum) # Heteroscedasticity!
View(gas15.cum)
hist(gas15.cum$total.Ngas, breaks=binsize1)
ggplot(gas15.cum, aes(x= Lt, y=total.Ngas),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.total.Ngas) +
xlab("italic(L.~terrestris)") +
ggtitle("Total N2O") +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
ggplot(gas15.cum, aes(x= Lt, y=total.Ngas),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab("total.Ngas") +
xlab("italic(L.~terrestris)") +
ggtitle("Total N2O") +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
gas15.cum$nitox.soil <- gas15.cum$nitox.gc - gas15.cum$nitox # Double interaction factor for TukeyHSD Tests
ggplot(gas15.cum, aes(x= Lt, y=nitox.gc),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.nitox.gc) +
xlab("italic(L.~terrestris)") +
ggtitle("Total N2O") +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
ggplot(gas15.cum, aes(x= Lt, y=log1p(nitox.gc)),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.nitox.gc) +
xlab("italic(L.~terrestris)") +
ggtitle("Total N2O") +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
