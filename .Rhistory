source("Analysis/RequiredPackages.R")
source("Analysis/V1_RequiredPackages.R")
source("Analysis/V1_RequiredPackages.R")
source("Analysis/V1_RequiredPackages.R")
source("Data/GatherSOurce/V1_Gather1.R")
source("Data/GatherSOurce/V1_Gather1.R")
Lt.Exp1  = 100*(1-4/(4*2*2*2)) # = 87.5 %
Lt.Exp2  = 100*(1-0/(3*2*2*2)) # = 100 %
Lt.total = 100*(1-4/((4*2*2*2)+(3*2*2*2))) # = 92.86 %
rbind(Lt.Exp1, Lt.Exp2,Lt.total)
with(ew.bm, list(length(before), range(before),range(after)))
bs.worms1 = binsize1 = diff(range(ew.bm$before))/26
bs.worms2 = binsize2 = diff(range(ew.bm$after))/26
bs.worms3 = binsize3 = diff(range(ew.bm$diff))/length(ew.bm$diff)
SurvivalRates <- rbind(Lt.Exp1, Lt.Exp2,Lt.total)
View(SurvivalRates)
setnames(Lt.SurvivalRates) <- "%"
Exp1  = 100*(1-4/(4*2*2*2)) # = 87.5 %
Exp2  = 100*(1-0/(3*2*2*2)) # = 100 %
Total = 100*(1-4/((4*2*2*2)+(3*2*2*2))) # = 92.86 %
Lt.SurvivalRates <- rbind(Exp1,Exp2,Total)
setnames(Lt.SurvivalRates) <- "%"
set.names(Lt.SurvivalRates) <- "%"
?setnames
??set.names
?set.names
??setnames
colnames(Lt.SurvivalRates)[1] <- "%"
View(Lt.SurvivalRates)
X <- c("Exp1", "Exp2", "Total")
Y <- c(100*(1-4/(4*2*2*2)), 100*(1-0/(3*2*2*2)), 100*(1-4/((4*2*2*2)+(3*2*2*2))))
Lt.SurvivalRates <- matrix(X,Y,2)
View(Lt.SurvivalRates)
Lt.SurvivalRates <- matrix(list(X,Y),3,2)
View(Lt.SurvivalRates)
Lt.SurvivalRates <- matrix(c(X,Y),3,2)
View(Lt.SurvivalRates)
rm(Exp1,Exp2,Total)
ew.bm.melt = melt(ew.bm[,-c(7,8)], id.vars=c(1:4))
ew.bm.p1 <- ggplot(ew.bm.melt, aes(x=value)) +
geom_histogram( binwidth = bs.worms1, fill="lightblue3", colour="black") +
geom_line(stat="density") +
xlim(6.5,11) +
xlab("Biomass [g]") +
ylab("Frequency") +
ggtitle("Histograms EW-biomass \n Before/After") +
facet_grid(variable ~ .) + mytheme
source("Analysis/V1_RequiredPackages.R")
ew.bm.melt = melt(ew.bm[,-c(7,8)], id.vars=c(1:4))
ew.bm.p1 <- ggplot(ew.bm.melt, aes(x=value)) +
geom_histogram( binwidth = bs.worms1, fill="lightblue3", colour="black") +
geom_line(stat="density") +
xlim(6.5,11) +
xlab("Biomass [g]") +
ylab("Frequency") +
ggtitle("Histograms EW-biomass \n Before/After") +
facet_grid(variable ~ .) + mytheme
rm(ew.bm.melt)
ew.bm.p1
ew.bm.p2 <- ggplot(ew.bm, aes(x=diff)) +
geom_histogram(binwidth = bs.worms3, fill="lightblue3", colour="black") +
geom_line(stat="density") +
xlab("differences [g]") +
ylab("Frequency") +
ggtitle("Histogram of differences") + mytheme
ew.bm.p2
View(ew.bm)
ew.bm.melt = melt(ew.bm[,-8], id.vars=c(1:4))
ew.bm.p1 <- ggplot(ew.bm.melt, aes(x=value)) +
geom_histogram( binwidth = bs.worms1, fill="lightblue3", colour="black") +
geom_line(stat="density") +
xlim(6.5,11) +
xlab("Biomass [g]") +
ylab("Frequency") +
ggtitle("Histograms EW-biomass \n Before/After") +
facet_grid(variable ~ .) + mytheme
ew.bm.p1; rm(ew.bm.melt)
ew.bm.p2 <- ggplot(ew.bm, aes(x=diff)) +
geom_histogram(binwidth = bs.worms3, fill="lightblue3", colour="black") +
geom_line(stat="density") +
xlab("differences [g]") +
ylab("Frequency") +
ggtitle("Histogram of differences") + mytheme
ew.bm.p2
# Histograms Before/After
ew.bm.melt = melt(ew.bm[,-8], id.vars=c(1:4))
ew.bm.p1 <- ggplot(ew.bm.melt, aes(x=value)) +
geom_histogram( binwidth = bs.worms1, fill="lightblue3", colour="black") +
geom_line(stat="density") +
#xlim(6.5,11) +
xlab("Biomass [g]") +
ylab("Frequency") +
ggtitle("Histograms EW-biomass \n Before/After") +
facet_grid(variable ~ .) + mytheme
ew.bm.p1; rm(ew.bm.melt)
ew.bm.melt = melt(ew.bm[,-8], id.vars=c(1:4))
ew.bm.p1 <- ggplot(ew.bm.melt, aes(x=value)) +
geom_histogram( binwidth = bs.worms1, fill="lightblue3", colour="black") +
geom_line(stat="density") +
#xlim(6.5,11) +
xlab("Biomass [g]") +
ylab("Frequency") +
ggtitle("Histograms EW-biomass \n Before/After") +
facet_grid(. ~ variable) + mytheme
ew.bm.p1; rm(ew.bm.melt)
ew.bm.melt = melt(ew.bm[,-8], id.vars=c(1:4))
ew.bm.p1 <- ggplot(ew.bm.melt, aes(x=value)) +
geom_histogram( binwidth = bs.worms1, fill="lightblue3", colour="black") +
geom_line(stat="density") +
#xlim(6.5,11) +
xlab("Biomass [g]") +
ylab("Frequency") +
ggtitle("Histograms EW-biomass \n Before/After") +
facet_grid( ~ variable) + mytheme
ew.bm.p1; rm(ew.bm.melt)
# One figure in row 1 and two figures in row 2
grid.newpage()
pushViewport(viewport(layout = grid.layout(1, 2)))
print(ew.bm.p1, vp = vplayout(1, 1))
print(ew.bm.p2, vp = vplayout(1, 2))
# create binsizes for Histograms
binsize1 = diff(range(ew.bm$before))/26
binsize2 = diff(range(ew.bm$after))/26
binsize3 = diff(range(ew.bm$diff))/length(ew.bm$diff)
# Histograms Before/After
ew.bm.melt = melt(ew.bm[,-c(7,8)], id.vars=c(1:4))
ew.bm.p1 <- ggplot(ew.bm.melt, aes(x=value)) +
geom_histogram( binwidth = binsize1, fill="lightblue3", colour="black") +
geom_line(stat="density") +
xlim(6.5,11) +
xlab("Biomass [g]") +
ylab("Frequency") +
ggtitle("Histograms EW-biomass \n Before/After") +
facet_grid( ~ variable) + mytheme
# normally distributed differences?
ew.bm.p2 <- ggplot(ew.bm, aes(x=diff)) +
geom_histogram(binwidth = binsize3, fill="lightblue3", colour="black") +
geom_line(stat="density") +
xlab("differences [g]") +
ylab("Frequency") +
ggtitle("Histogram of differences") + mytheme
# One figure in row 1 and two figures in row 2
grid.newpage()
pushViewport(viewport(layout = grid.layout(1, 2)))
print(ew.bm.p1, vp = vplayout(1, 1))
print(ew.bm.p2, vp = vplayout(1, 2))
rm(ew.bm.melt)
# Ranges
with(ew.bm, list(length(before), range(before),range(after)))
# create binsizes for Histograms
binsize1 = diff(range(ew.bm$before))/26
binsize2 = diff(range(ew.bm$after))/26
binsize3 = diff(range(ew.bm$diff))/length(ew.bm$diff)
# Histograms Before/After
ew.bm.melt = melt(ew.bm[,-c(7,8)], id.vars=c(1:4))
ew.bm.p1 <- ggplot(ew.bm.melt, aes(x=value)) +
geom_histogram( binwidth = binsize1, fill="lightblue3", colour="black") +
geom_line(stat="density") +
xlim(6.5,11) +
xlab("Biomass [g]") +
ylab("Frequency") +
ggtitle("Histograms EW-biomass \n Before/After") +
facet_grid(variable ~ .) + mytheme
# normally distributed differences?
ew.bm.p2 <- ggplot(ew.bm, aes(x=diff)) +
geom_histogram(binwidth = binsize3, fill="lightblue3", colour="black") +
geom_line(stat="density") +
xlab("differences [g]") +
ylab("Frequency") +
ggtitle("Histogram of differences") + mytheme
# One figure in row 1 and two figures in row 2
grid.newpage()
pushViewport(viewport(layout = grid.layout(1, 2)))
print(ew.bm.p1, vp = vplayout(1, 1))
print(ew.bm.p2, vp = vplayout(1, 2))
rm(ew.bm.melt, binsize1, binsize2, binsize3)
source(Data/GatherSource/V1_MakeLikeFile.R)
source(/Data/GatherSource/V1_MakeLikeFile.R)
source("Data/GatherSource/V1_MakeLikeFile.R")
hist(gas15.cum$nitox.soil, breaks=binsize1)
binsize1 = sqrt(length(gas15.cum$product.ratio))
hist(gas15.cum$nitox.soil, breaks=binsize1)
# Boxplots
ggplot(gas15.cum, aes(x= Lt, y=nitox.soil),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.nitox.soil) +
xlab("italic(L.~terrestris)") +
ggtitle("Total N2O") +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
txt.nitox.soil = expression(paste(N[2],"O"[soil]," [Âµg ",N[2],"O-N ",kg^-1, h^-1,"]"))
# Boxplots
ggplot(gas15.cum, aes(x= Lt, y=nitox.soil),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue", lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(txt.nitox.soil) +
xlab("italic(L.~terrestris)") +
ggtitle("Total N2O") +
facet_grid(~soil, labeller=label_parsed) +
scale_x_discrete(expression(italic(L.~terrestris)), labels=c("absent","present")) +
mytheme
gas15.nxt.aov <- aov(nitox.soil~soil*Lt*Fc, gas15.cum); summary(gas15.nxt.aov)
gas15.nxt.aov <- aov(log1p(nitox.soil)~soil*Lt*Fc, gas15.cum); summary(gas15.nxt.aov)
gas15.nxt.aov <- update(gas15.nxt.aov,.~soil*Lt, gas15.cum); summary(gas15.nxt.aov)
par(mfrow=c(2,2))
par(mar=c(3,3,3,3))
plot(gas15.nxt.aov)
fligner.test(log1p(nitox.soil)~interaction(soil,Lt), gas15.cum) # Homoscedasticity
with(gas15.cum, list( tapply(nitox.soil, list(soil,Lt), mean),
tapply(nitox.soil, list(soil,Lt), se)))
with(gas15.cum, list( tapply(nitox.soil, list(soil,Lt,Fc), mean),
tapply(nitox.soil, list(soil,Lt,Fc), se)))
with(gas15.cum, list( tapply(nitox.soil, list(soil,treat), mean),
tapply(nitox.soil, list(soil,treat), se)))
with(gas15.cum, list( tapply(nitox.soil, list(treat,soil), mean),
tapply(nitox.soil, list(treat,soil), se)))
co2.index$Lt <- revalue(co2.index$treat, c(Lt=1, int=1, Fc=0, C=0))
co2.index$Fc <- revalue(co2.index$treat, c(Lt=0, int=1, Fc=1, C=0))
co2.cum <- as.data.frame(cbind(co2.index[c(1:56),][-c(8,22),], co2.cum))
colnames(co2.cum)[21] <- "cc"
colnames(co2.cum)[4] <- "exp"
co2.cum <- droplevels(co2.cum)
co2.cum.org <- co2.cum
#co2.cum <- co2.cum.org
co2.cum <- co2.cum[-1,]
co2.cum <- co2.cum[-1,]
### Experiment 1
# multimodel averaging
x <- c("Lt","Fc","exp","soil")
cc.0 <- lm(cc~Lt*Fc*soil, co2.cum[!(co2.cum$exp=="exp2"),])
#t(combn(x,3))
cc.1 <- lm(cc~Lt*Fc, co2.cum[!(co2.cum$exp=="exp2"),])
cc.2 <- lm(cc~Lt*soil, co2.cum[!(co2.cum$exp=="exp2"),])
cc.3 <- lm(cc~Fc*soil, co2.cum[!(co2.cum$exp=="exp2"),])
#t(combn(x,2))
cc.4 <- lm(cc~Lt, co2.cum[!(co2.cum$exp=="exp2"),])
cc.5 <- lm(cc~Fc, co2.cum[!(co2.cum$exp=="exp2"),])
cc.6 <- lm(cc~soil, co2.cum[!(co2.cum$exp=="exp2"),])
cc.7 <- lm(cc~1, co2.cum[!(co2.cum$exp=="exp2"),])
AICctab(cc.0,  cc.1,  cc.2,  cc.3,  cc.4,  cc.5,  cc.6,  cc.7)
test1 <- aov(cc~Lt + soil, co2.cum[!(co2.cum$exp=="exp2"),])
summary(test1)
test1 <- aov(cc~Lt*soil, co2.cum[!(co2.cum$exp=="exp2"),])
summary(test1)
library(lme4)
session.info()
sessioninfo()
?session.info
?? session info
??session
session_info()
sessionInfo
sessionInfo()
citation(package = "MuMIn", lib.loc = NULL)
citation(package = "vegan", lib.loc = NULL)
citation(package = "MASS", lib.loc = NULL)
source("Data/GatherSource/V1_MakeLikeFile.R")
initial = 238 #Ind/MC
# How many times more collembolans afterwards?
col.pop$growth = col.pop$surface/initial
mean(col.pop$growth); se(col.pop.growth)
mean(col.pop$growth); se(col.pop.growth)
mean(col.pop$growth); se(col.pop$growth)
range(col.pop$growth)
col.pop$exp <- revalue(col.pop$exp, c(Exp1="Experiment~1",Exp2="Experiment~2"))
col.pop$treat <- revalue(col.pop$treat, c(C ="F.~candida",RC="Interaction"))
ggplot(col.pop, aes(x= treat, y=surface),labeller=label_parsed) +
stat_boxplot(geom="errorbar", coef=1.5, lwd=0.2) +
geom_boxplot(fill="light blue",lwd=0.2, outlier.size=0.4, outlier.shape=21) +
ylab(expression(paste("Collembolan density [Ind ",MC[surface]^-1,"]"))) +
xlab("Treatment") +
ggtitle(expression(paste("Boxplots for collembolan density per ",MC[surface]))) +
facet_grid(exp~soil, labeller=label_parsed) +
scale_x_discrete("Treatment", labels=expression(italic(F.~candida), Interaction)) +
mytheme
with(col.pop, tapply(surface, list(soil, treat, exp), mean))
cp.lm1 <- lm(surface ~ treat*soil*exp, data=col.pop);cp.lm1; summary.aov(cp.lm1);summary.lm(cp.lm1)
cp.lm2 <- lm(surface ~ treat*soil*exp-exp:treat:soil, data=col.pop);cp.lm2; summary.aov(cp.lm2);summary.lm(cp.lm2)
plot.design(surface ~ soil*exp*treat-exp:treat:soil, data=col.pop)
glht(cp.lm2, linfct = mcp("tukey"))
TukeyHSD(cp.aov)
?glht
glht(cp.lm1, linfct = mcp("tukey"))
cp.int_f <- with(col.pop, interaction(soil,treat,exp))
cp.tuk1 <- lm(col.pop ~ interaction)
cp.tuk1 <- lm(surface ~ interaction, col.pop)
cp.tuk1 <- lm(surface ~ cp.int_f, col.pop)
glht(cp.lm1, linfct = mcp(cp.int_f="tukey"))
glht(cp.tuk1, linfct = mcp(cp.int_f="tukey"))
glht(cp.tuk1, linfct = mcp(cp.int_f="Tukey"))
par(mfrow=c(1,1))
with(col.pop, { plot(surface, pch=21, col="black",bg="red")
abline(mean(surface),0, col="blue")
title("SST")
ylab="response (surface)"
for (i in 1:28)
lines(c(i,i), c(surface[i], mean(surface)), col="green")
})
TukeyHSD(cp.tuk1)
cp.tuk1 <- glht(cp.tuk1, linfct = mcp(cp.int_f="Tukey"))
summary(cp.tuk1)
TukeyHSD(cp.tuk1)
col.pop.int <- cp.int <- with(col.pop, interaction(exp,soil,treat)) # Triple interaction factor
col.aov2 <- aov(surface ~ cp.int, data=col.pop)
HSD.test(col.aov2, "cp.int", group=TRUE, console=TRUE)
col.tuk1 <- glht(col.aov2, linfct = mcp(cp.int = "Tukey"))
summary(col.tuk1)          # standard display
col.tuk.cld <- cld(col.tuk1)   # letter-based display
par(mai=c(1,1,1.1,0.2),
mfrow=c(1,1),
mgp=c(2,1,0),
cex=0.8) # mai specifiec margin size in inches
plot(col.tuk.cld, cex=0.5, las=2, col="grey", xaxt="n")
axis(1, at=cp.int,labels=FALSE)
text(cp.int, labels=cp.int, par("usr")[3], adj=c(1.2,1.2), xpd=TRUE, srt=45, cex=0.8)
col.pop.effects <- allEffects(cp.lm2)
plot(col.pop.effects, "treat:soil")
plot(col.pop.effects, "treat:exp")
plot(col.pop.effects, "soil:exp")
model.tables(cp.aov, "means", se=TRUE)
model.tables(cp.lm1, "means", se=TRUE)
cp.aov <- aov(surface ~ treat*soil*exp-exp:treat:soil, data=col.pop)
model.tables(cp.lm1, "means", se=TRUE)
with(col.pop, tapply(surface, list(treat,soil), mean))
model.tables(cp.aov, "means", se=TRUE)
with(col.pop, tapply(surface, list(treat,soil), mean))
with(col.pop, tapply(surface, list(treat,soil), se))
with(col.pop, tapply(surface, list(treat,exp), mean))
with(col.pop, tapply(surface, list(treat,exp), se))
with(col.pop, tapply(surface, list(soil,exp), mean))
with(col.pop, tapply(surface, list(soil,exp), se))
col.pop.effects <- allEffects(cp.lm1)
plot(col.pop.effects, "treat:soil:exp")
treat.sand.exp1 = a = 9629 - 6319
treat.sand.exp2 = b = 18781 - 14766
treat.loam.exp2 = c = 11246 - 4487
cp.diff.means = c(a,b,c)
mean(cp.diff.means); se(cp.diff.means)
cp.int <- with(col.pop, interaction(treat, soil))
aov.col1 <- aov(surface ~ cp.int, data=col.pop)
HSD.test(aov.col1, "cp.int", group=TRUE, console=TRUE)
